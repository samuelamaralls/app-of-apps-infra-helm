gitlabUrl: "http://gitlab.thesams.site/"

runnerRegistrationToken: "GR1348941FtwcvVyXQRHzx4Ce9jbm"

serviceAccount:
  create: true
  name: gitlab-runner

rbac:
  create: true

podSecurityContext:
  # Remove runAsUser 0 pois pode gerar conflito com políticas restritivas
  fsGroup: 0

containerSecurityContext:
  privileged: true
  allowPrivilegeEscalation: true

config: |
  concurrent = 10
  check_interval = 0

  [session_server]
    session_timeout = 1800

  [[runners]]
    name = "my-gitlab-runner"
    executor = "kubernetes"
    environment = ["DOCKER_DRIVER=overlay2"]

    [runners.kubernetes]
      namespace = "gitlab-runner"
      privileged = true
      image_pull_policy = "IfNotPresent"
      poll_timeout = 180
      service_account = "gitlab-runner"
      helper_image = "gitlab/gitlab-runner-helper:x86_64-latest"
      # Use imagem base do job como docker:latest, não define aqui
      # image é definida pelo job CI

    [runners.feature_flags]
      FF_ENABLE_JOB_TRACE_LOG_ROTATION = true

tags: "default"
